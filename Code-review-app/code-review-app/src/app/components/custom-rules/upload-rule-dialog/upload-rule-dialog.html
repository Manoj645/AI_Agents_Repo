<h2 mat-dialog-title>
  <mat-icon>upload</mat-icon>
  Upload Custom Rule
</h2>

<mat-dialog-content>
  <div class="upload-container">
    <!-- File Upload Area -->
    <div class="file-upload-area" 
         (dragover)="onDragOver($event)" 
         (dragleave)="onDragLeave($event)"
         (drop)="onDrop($event)"
         [class.drag-over]="isDragOver"
         (click)="fileInput.click()">
      
      <input #fileInput type="file" 
             (change)="onFileSelected($event)" 
             accept=".md,.txt,.py,.js,.ts,.java,.cpp,.c,.cs,.php,.rb,.go,.rs"
             style="display: none;">
      
      <div class="upload-content">
        <mat-icon class="upload-icon">cloud_upload</mat-icon>
        <h3>Drop your rule file here or click to browse</h3>
        <p>Supported formats: .md, .txt, .py, .js, .ts, .java, .cpp, .c, .cs, .php, .rb, .go, .rs</p>
        <p class="file-size-limit">Maximum file size: 5MB</p>
      </div>
    </div>

    <!-- File Preview -->
    <div *ngIf="selectedFile" class="file-preview">
      <div class="file-info">
        <mat-icon>description</mat-icon>
        <div class="file-details">
          <h4>{{selectedFile.name}}</h4>
          <p>{{(selectedFile.size / 1024).toFixed(1)}} KB</p>
        </div>
        <button mat-icon-button (click)="removeFile()" matTooltip="Remove file">
          <mat-icon>close</mat-icon>
        </button>
      </div>
    </div>

    <!-- Rule Configuration -->
    <div *ngIf="selectedFile" class="rule-config">
      <h3>Rule Configuration</h3>
      
      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Rule Name</mat-label>
          <input matInput [(ngModel)]="ruleName" placeholder="Enter a descriptive name for this rule">
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline">
          <mat-label>Language</mat-label>
          <mat-select [(ngModel)]="selectedLanguage">
            <mat-option value="Python">Python</mat-option>
            <mat-option value="JavaScript">JavaScript</mat-option>
            <mat-option value="TypeScript">TypeScript</mat-option>
            <mat-option value="Java">Java</mat-option>
            <mat-option value="C++">C++</mat-option>
            <mat-option value="C#">C#</mat-option>
            <mat-option value="PHP">PHP</mat-option>
            <mat-option value="Go">Go</mat-option>
            <mat-option value="Rust">Rust</mat-option>
            <mat-option value="Ruby">Ruby</mat-option>
            <mat-option value="Markdown">Markdown</mat-option>
            <mat-option value="Text">Text</mat-option>
          </mat-select>
        </mat-form-field>

        <mat-form-field appearance="outline">
          <mat-label>Category</mat-label>
          <mat-select [(ngModel)]="selectedCategory">
            <mat-option value="Style">Style</mat-option>
            <mat-option value="Security">Security</mat-option>
            <mat-option value="Performance">Performance</mat-option>
            <mat-option value="Documentation">Documentation</mat-option>
            <mat-option value="Testing">Testing</mat-option>
            <mat-option value="General">General</mat-option>
          </mat-select>
        </mat-form-field>
      </div>

      <div class="form-row">
        <mat-form-field appearance="outline" class="full-width">
          <mat-label>Description (Optional)</mat-label>
          <textarea matInput [(ngModel)]="ruleDescription" 
                    placeholder="Brief description of what this rule covers"
                    rows="3"></textarea>
        </mat-form-field>
      </div>

      <!-- Content Preview -->
      <div class="content-preview">
        <h4>Content Preview</h4>
        <div class="preview-content">
          <pre>{{fileContent}}</pre>
        </div>
      </div>
    </div>
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">Cancel</button>
  <button mat-raised-button 
          color="primary" 
          (click)="onUpload()" 
          [disabled]="!selectedFile || !ruleName || !selectedLanguage || !selectedCategory || uploading">
    <mat-icon *ngIf="!uploading">upload</mat-icon>
    <mat-spinner *ngIf="uploading" diameter="20"></mat-spinner>
    {{uploading ? 'Uploading...' : 'Upload Rule'}}
  </button>
</mat-dialog-actions>
